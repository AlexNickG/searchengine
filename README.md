# Search Engine Project
### Дипломная работа по созданию локального поискового движка по сайтам 

Проект разработан на языке Java с использованием фреймворка Spring Boot Framework, а также библиотек лемматизаторов.

Приложение имеет несколько режимов работы:
- индексация по выбранным сайтам (также возможно добавление в индекс отдельных страниц);
- поиск по индексу по ключевым словам.

## Содержание
* [Основные функции](#основные-функции)
* [Технологии](#Технологии)
* [Структура проекта](#Структура-проекта)
* [Настройки для запуска](#Настройки-для-запуска)
* [Запуск приложения](#Запуск-приложения)

## Основные функции

- **Индексация веб-страниц**:
  - Поиск и сохранение структуры страниц.
  - Работа с обработкой ссылок и документов.
  - Многопоточное выполнение для повышения производительности.
- 
- **Работа с БД**:
  - Хранение информации о сайтах, страницах, леммах и индексах.
  - Поддержка операций для очистки или обновления данных.
  - Поиск по базе данных и выдача результатов поиска.
- 
- **Поиск**:
  - Обработка запросов пользователей.
  - Использование лемматизации для улучшения качества поисковых запросов.

## Технологии

- **Язык программирования**: Java 17
- **Фреймворк**: Spring Boot
- **Используемые библиотеки**:
  - `Slf4j` для логирования.
  - Работа с потоками: `ForkJoinTask`, `ExecutorService`.
  - Java Collections (`ConcurrentSkipListSet`, `AtomicInteger` и др.).

- **Базы данных**:
  - Сущности подключены через JPA (репозитории).
  - Таблицы базы данных создаются автоматически при запуске приложения при помощи Liquibase.

## Структура проекта

В нашем случае будем придерживаться простой слоистой структуре (еще можно назвать "луковичная"). У нас есть
три слоя:

* **Presentation** - Наши контроллеры. слой общается с пользователями, в нашем случае ожидает запросы по API. И отдает
  ответы.
* **Business** - самый важный слой - бизнес логика, содержится в классах Сервисах. Этот слой ничего не знает о
  Presentation
  слое
* **Data Access** - слой отвечает за хранение данных, подключение к БД, реализацию запросов. Слой не знает о других
  слоях
  ничего. У нас это классы Репозитории.

Каждый слой занимается только своими задачами и работа одного слоя не должна перетекать в другой. Например, Контроллер
должен только получать данные от пользователя и вызывать нужный сервис, не более. Все расчеты и проверки должны быть в
классах сервисах.

Если посмотреть слои данного приложения, то увидим не только сами классы, но еще и интерфейсы между ними.

Интерфейсы нужны, чтобы слои приложения не зависели от реализаций классов. Каждый из классов LemmaController и
MorphologyServiceImpl зависят от интерфейса MorphologyService. Это значит, что сервисы и контроллеры могут меняться
независимо, заменяться и это не будет влиять на другие слои.

Также это относится и к передаваемым данным, у каждого слоя
может быть свои структуры для хранения данных, например Репозитории отдают Entity классы, а сервисы уже упаковывают в
нужные объекты, снова для того чтобы конечный потребитель данных не зависел напрямую от структуры данных в БД. БД может
измениться, поменять структуру таблиц - и это должно произойти максимально незаметно для других слоев.
- **`searchengine.services`**:
  - Основной пакет с реализацией логики индексации и поиска.
  - Классы:
    - `IndexingServiceImpl` — отвечает за индексацию страниц, организацию потоков, работу с базой.
    - `LemmaFinder` — выполняет лемматизацию текста.
    - `SearchServiceImpl` — обработка пользовательских поисковых запросов.

- **`searchengine.repositories`**:
  - Отвечает за работу с базой данных:
    - `IndexRepository` — хранение данных об индексах.

- **Ключевые конфигурации**:
  - `application.yaml` — хранит настройки подключения, включая параметры индексации (`userAgent`, `referrer`, `timeout`).
## Основные классы и их функционал

### **`IndexingServiceImpl`**
Реализует логику индексации:
- Многопоточная обработка (с использованием `ExecutorService` и потоков).
- Методы:
  - `startIndexing()` — запускает процесс индексации.
  - `stopIndexing()` — завершает текущую индексацию.
  - `addPageForIndexing(String url)` — добавляет отдельные страницы в индекс.
  - `clearDb()` — очищает базу данных.

Поддерживает обработку множества сайтов (`Site`, `Page`, `Lemma`, `Index`).

### **`LemmaFinder`**
- Реализует лемматизацию текста, улучшая точность работы поисковой системы.
## Настройки для запуска
В файле настроек проекта application.yaml задается перечень сайтов для
индексации.
### Настройки подключения к БД

В проект добавлен драйвер для подключения к БД MySQL. Для запуска проекта,
убедитесь, что у вас запущен сервер MySQL 8.x.

Создайте бд `search_engine` и замените логин и пароль в файле конфигурации `application.yaml`:

```yaml
spring:
  datasource:
    username: # имя пользователя
    password: # пароль пользователя
```
В разделе connection-settings файла application.yaml есть параметр
timeout (по умолчанию равен 550 мс), который можно увеличить,
если индексируемый сайт блокирует подключение из-за слишком частых запросов.
После этого, можете запустить проект. Если введены правильные данные,
проект успешно запустится. Если запуск заканчивается ошибками, изучите текст
ошибок, внесите исправления и попробуйте заново.

## Запуск приложения
В папке приложения выполните команду:
```shell
java -jar search-engine-0.0.1-SNAPSHOT.jar
```
После запуска приложения, перейдите в браузере по адресу `http://localhost:8080/` для доступа к интерфейсу поиска.
При работе приложения в подпапке logs проекта создаются лог-файлы логов stderr.log и stdinfo.log, в которых можно найти информацию о процессе работы приложения.








